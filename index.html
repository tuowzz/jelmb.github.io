<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>M-BLITHE ‡∏Ñ‡∏≠‡∏ô‡∏ã‡∏µ‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå | Shopee Vibe</title>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <!-- Facebook Pixel Code -->
  <script>
    !function(f,b,e,v,n,t,s){
      if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '127978927946856');
    fbq('track', 'PageView');
  </script>
  <noscript>
    <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=127978927946856&ev=PageView&noscript=1"/>
  </noscript>
  <!-- End Facebook Pixel Code -->
  <style>
    :root {
      --shopee-orange: #ee4d2d;
      --shopee-green: #06c755;
      --shopee-gray: #f5f5f5;
      --white: #fff;
      --border: #e0e0e0;
    }
    body {
      font-family: 'Kanit', sans-serif;
      margin: 0;
      background: var(--shopee-gray);
      color: #222;
      padding-bottom: 75px;
    }
    .header-bar {
      background: var(--shopee-orange);
      color: #fff;
      padding: 13px 0 11px 0;
      text-align: center;
      font-weight: 700;
      font-size: 1.2rem;
      box-shadow: 0 2px 8px rgba(238,77,45,.08);
      letter-spacing: 0.7px;
    }
    .product-card {
      background: #fff;
      margin: 24px auto 10px auto;
      border-radius: 12px;
      width: 100%;
      max-width: 440px;
      min-width: 0;
      box-shadow: 0 1px 8px rgba(0,0,0,.06);
      padding: 0 0 15px 0;
      border: 1.5px solid var(--border);
      position: relative;
    }
    .product-img {
      width: 100%;
      border-radius: 12px 12px 0 0;
      border-bottom: 1.5px solid var(--border);
      aspect-ratio: 1/1;
      object-fit: cover;
      background: #fafbfc;
      display: block;
    }
    .shop-badge {
      background: var(--shopee-orange);
      color: #fff;
      font-size: 1.01rem;
      font-weight: 700;
      display: inline-block;
      padding: 6px 14px;
      border-radius: 0 0 14px 0;
      position: absolute;
      left: 0; top: 0;
      letter-spacing: .7px;
    }
    .product-details {
      padding: 21px 22px 5px 22px;
    }
    .product-title {
      font-size: 1.27rem;
      font-weight: 700;
      color: #222;
      margin-bottom: 7px;
    }
    .rating-row {
      color: #ffb400;
      font-size: 1.08rem;
      margin-bottom: 7px;
    }
    .price-row {
      font-size: 1.58rem;
      font-weight: 700;
      color: var(--shopee-orange);
      margin-bottom: 7px;
      display: flex; align-items: end; gap: 13px;
    }
    .price-row .old-price {
      color: #888; font-size: 1.18rem;
      text-decoration: line-through;
      font-weight: 400;
    }
    .badges {
      margin-bottom: 7px;
    }
    .badge {
      display: inline-block;
      font-size: 1rem;
      background: #ffe5d2;
      color: var(--shopee-orange);
      border-radius: 5px;
      padding: 2px 12px;
      margin-right: 6px;
      font-weight: 600;
      margin-bottom: 5px;
    }
    .scarcity {
      background: #fff7ed;
      border: 1px dashed var(--shopee-orange);
      color: var(--shopee-orange);
      font-weight: 700;
      text-align: center;
      font-size: 1.07rem;
      border-radius: 6px;
      margin: 8px 0 14px 0;
      padding: 9px;
      animation: shake .95s infinite alternate;
    }
    @keyframes shake {
      0% { transform: translateY(0);}
      80% { transform: translateY(-1px);}
      100% { transform: translateY(2px);}
    }
    .options-container {
      display: flex; gap: 9px; margin: 13px 0 11px 0; flex-wrap: wrap;
    }
    .option-btn {
      border: 2px solid #eee;
      border-radius: 8px;
      background: #fff;
      font-size: 1.07rem;
      font-weight: 700;
      color: #222;
      padding: 8px 19px;
      cursor: pointer;
      transition: border 0.14s, background 0.13s, color 0.13s;
      outline: none;
    }
    .option-btn.selected {
      border-color: var(--shopee-orange);
      background: #ffe5d2;
      color: var(--shopee-orange);
      box-shadow: 0 1px 7px #ffd2bb44;
    }
    .product-actions {
      margin-top: 22px;
    }
    .buy-btn, .line-btn {
      display: flex !important;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      height: 52px;
      font-size: 1.18rem;
      font-weight: 700;
      border-radius: 9px;
      border: none;
      margin-bottom: 12px;
      cursor: pointer;
      transition: background .16s;
      box-shadow: 0 1px 7px #eee;
      letter-spacing: .03em;
      text-decoration: none;
    }
    .buy-btn {
      background: var(--shopee-orange);
      color: #fff !important;
    }
    .buy-btn:active { background: #d53b1a; }
    .line-btn {
      background: var(--shopee-green);
      color: #fff !important;
    }
    .line-btn:active { background: #0d9c45;}
    .line-btn i { font-size: 1.35rem; }
    .buy-btn i { font-size: 1.22rem;}
    .benefits-list {
      margin: 16px 0 10px 0;
      font-size: 1.05rem;
    }
    .benefits-list li {
      margin-bottom: 6px;
    }
    .review-box {
      background: #fdf7f2;
      border-radius: 8px;
      margin: 10px 0;
      padding: 15px;
      font-size: 1.07rem;
      color: #222;
    }
    .review-header { color: #ffb400; font-weight: 600;}
    .footer-bar {
      position: fixed; left: 0; right: 0; bottom: 0;
      background: #fff;
      border-top: 1.5px solid #f2cbb4;
      display: flex;
      max-width: 440px;
      width: 100%;
      margin: auto;
      z-index: 20;
      height: 60px;
      box-shadow: 0 -2px 16px 0 #ffd4bb55;
    }
    .footer-bar .line-btn, .footer-bar .buy-btn {
      height: 100%; margin: 0; border-radius: 0;
      font-size: 1.11rem;
      padding: 0;
    }
    .footer-bar .line-btn { width: 41%; }
    .footer-bar .buy-btn { width: 59%; }
    @media (max-width: 700px) {
      .product-card, .footer-bar { max-width: 100vw; border-radius: 0;}
      .product-details { padding: 11px 7px 5px 7px;}
      .footer-bar { height: 62px; }
    }
    @media (max-width: 500px) {
      .product-details { padding: 8px 2px 5px 2px;}
      .modal-content { padding: 13px 3px 9px 3px;}
      #successPopup { padding: 19px 11px; font-size: 1.07rem;}
    }
    /* Modal Responsive */
    .modal-overlay {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.41); z-index: 9999;
      display: none; justify-content: center; align-items: center;
      animation: fadeInBg 0.22s;
    }
    @keyframes fadeInBg {
      from { background: rgba(0,0,0,0.0);}
      to { background: rgba(0,0,0,0.41);}
    }
    .modal-content {
      background: #fff;
      border-radius: 17px;
      width: 96vw;
      max-width: 410px;
      box-shadow: 0 3px 26px #0004;
      position: relative;
      padding: 27px 23px 17px 23px;
      animation: slideUp .21s cubic-bezier(0.4,1.13,0.41,1.32);
      margin: 0 auto;
      display: flex; flex-direction: column;
    }
    @keyframes slideUp { from { transform: translateY(30%); opacity:0 } to { transform: translateY(0); opacity:1} }
    .close-btn {
      position: absolute; top: 13px; right: 15px; font-size: 1.7rem; color: #b5b5b5; cursor: pointer; z-index: 10;
    }
    .modal-header {
      display: flex; gap: 16px; align-items: center; border-bottom: 1px solid #f2f2f2; padding-bottom: 12px; margin-bottom: 14px;
    }
    .modal-header img {
      width: 65px; height: 65px; border-radius: 7px; object-fit: cover; border: 1px solid #eaeaea;
    }
    .modal-header-title { font-weight:700; font-size:1.14rem;}
    .modal-header-price { color:var(--shopee-orange);font-size:1.23rem;font-weight:700;}
    .modal-selection-text { font-size:1.06rem; color:#888; margin-top:2px;}
    #orderForm label { font-size: 1.03rem; font-weight: 600; display: block; margin-bottom: 8px; margin-top: 11px; }
    #orderForm input, #orderForm textarea {
      width: 100%; padding: 13px; font-size: 1.11rem; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-family: 'Kanit', sans-serif;
    }
    .modal-submit-btn {
      width: 100%; background-color: var(--shopee-orange); color: var(--white); border: none; padding: 15px; border-radius: 6px;
      font-size: 1.11rem; font-weight: 700; cursor: pointer; margin-top: 14px; font-family: 'Kanit', sans-serif;
      box-shadow: 0 1px 8px #ffd2bb33;
      letter-spacing: 0.01em;
    }
    .modal-submit-btn:disabled { background-color: #d5d5d5; cursor: not-allowed; }
    #successPopup {
      display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: rgba(255,255,255,0.96); color: #24b572; padding: 33px 55px; border-radius: 18px;
      z-index: 99999; text-align: center; font-size: 1.21rem; font-weight: 600; box-shadow: 0 5px 32px #0002;
      animation: fadeIn 0.18s;
    }
    #successPopup i { font-size: 2.8rem; margin-bottom: 9px; color: #16cf3b; }
    @keyframes fadeIn { from { opacity: 0;} to { opacity: 1;} }
    @media (max-width: 700px) {
      .modal-content { width: 100vw; border-radius: 15px 15px 0 0; padding: 21px 9px 13px 9px; max-width: 100vw; }
      .modal-overlay { align-items: flex-end; }
    }
  </style>
</head>
<body>
  <div class="header-bar">
    <i class="fa-solid fa-bag-shopping"></i> M-BLITHE Official Store
  </div>
  <div class="product-card">
    <span class="shop-badge"><i class="fa-solid fa-check"></i> Official</span>
    <img src="photo_2025-06-10_00-30-00.jpg" class="product-img" alt="M-BLITHE ‡∏Ñ‡∏≠‡∏ô‡∏ã‡∏µ‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå" />
    <div class="product-details">
      <div class="product-title">‡∏Ñ‡∏≠‡∏ô‡∏ã‡∏µ‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå M-BLITHE (‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≥)</div>
      <div class="rating-row">
        <i class="fa-solid fa-star"></i> 4.9 | ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß 9,000+
      </div>
      <div class="price-row">
        ‡∏ø299 <span class="old-price">‡∏ø390</span>
      </div>
      <div class="badges">
        <span class="badge">‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ</span>
        <span class="badge">‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</span>
        <span class="badge">‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</span>
      </div>
      <div class="scarcity">üî• ‡πÇ‡∏õ‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ <b>7 ‡∏ä‡∏¥‡πâ‡∏ô</b> ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!</div>
      <div>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏î‡∏™‡∏µ:</div>
      <div class="options-container" id="optionsContainer"></div>
      <ul class="benefits-list">
        <li>‚úÖ ‡∏õ‡∏Å‡∏õ‡∏¥‡∏î‡πÅ‡∏ô‡∏ö‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏≤‡∏ö</li>
        <li>üí¶ ‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≥ ‡∏Å‡∏±‡∏ô‡πÄ‡∏´‡∏á‡∏∑‡πà‡∏≠ ‡∏ï‡∏¥‡∏î‡∏ó‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô</li>
        <li>‚ú® ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ö‡∏≤‡∏á‡πÄ‡∏ö‡∏≤ ‡πÑ‡∏°‡πà‡∏≠‡∏∏‡∏î‡∏ï‡∏±‡∏ô</li>
        <li>üåø ‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô‡∏ï‡πà‡∏≠‡∏ú‡∏¥‡∏ß</li>
      </ul>
      <div class="review-box">
        <div class="review-header"><i class="fa-solid fa-user"></i> P***a</div>
        ‡∏õ‡∏Å‡∏õ‡∏¥‡∏î‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏ä‡∏≠‡∏ö‡∏°‡∏≤‡∏Å ‡∏™‡πà‡∏á‡πÄ‡∏£‡πá‡∏ß‡∏î‡πâ‡∏ß‡∏¢
      </div>
      <div class="review-box">
        <div class="review-header"><i class="fa-solid fa-user"></i> K***n</div>
        ‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ó‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡∏¥‡∏î‡∏ó‡∏ô ‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏±‡∏ô‡∏Å‡πá‡πÑ‡∏°‡πà‡∏´‡∏•‡∏∏‡∏î
      </div>
      <div class="product-actions">
        <button class="buy-btn" id="buyNowBtn"><i class="fa-solid fa-cart-shopping"></i> ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢</button>
        <a href="https://lin.ee/wKelfsp" target="_blank" class="line-btn">
          <i class="fa-brands fa-line"></i> ‡πÅ‡∏≠‡∏î‡πÑ‡∏•‡∏ô‡πå‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£
        </a>
      </div>
    </div>
  </div>
  <!-- Footer bar -->
  <div class="footer-bar">
    <a href="https://lin.ee/wKelfsp" target="_blank" class="line-btn">
      <i class="fa-brands fa-line"></i> ‡πÅ‡∏≠‡∏î‡πÑ‡∏•‡∏ô‡πå
    </a>
    <button class="buy-btn" id="buyNowBtn2">
      <i class="fa-solid fa-cart-shopping"></i> ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢
    </button>
  </div>
  <!-- MODAL ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ (‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°) -->
  <div class="modal-overlay" id="buyNowModal">
    <div class="modal-content">
      <i class="fas fa-times close-btn" id="closeModalBtn"></i>
      <div class="modal-header">
        <img src="photo_2025-06-10_00-30-00.jpg" alt="Product Thumbnail">
        <div>
          <div class="modal-header-title">M-BLITHE ‡∏Ñ‡∏≠‡∏ô‡∏ã‡∏µ‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå</div>
          <div class="modal-header-price">‡∏ø299</div>
          <div class="modal-selection-text">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏î‡∏™‡∏µ</div>
        </div>
      </div>
      <!-- ‡πÄ‡∏â‡∏î‡∏™‡∏µ -->
      <div class="options-container" id="modalOptionsContainer"></div>
      <form id="orderForm" onsubmit="sendOrderToSheet(event);" autocomplete="off">
        <input type="hidden" name="product" id="productInput" required>
        <label for="name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
        <input type="text" id="name" name="name" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
        <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
        <input type="text" id="phone" name="phone" required placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 0812345678" pattern="^[0-9]{10}$" title="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 10 ‡∏´‡∏•‡∏±‡∏Å">
        <label for="address">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</label>
        <textarea id="address" name="address" rows="3" required placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà, ‡∏ñ‡∏ô‡∏ô, ‡∏ï‡∏≥‡∏ö‡∏•, ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠, ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î, ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå"></textarea>
        <button type="submit" class="modal-submit-btn" id="submitBtn">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
      </form>
    </div>
  </div>
  <!-- Popup Success -->
  <div id="successPopup">
    <i class="fas fa-check-circle"></i>
    <p>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</p>
    <span style="color:#222;font-weight:400;display:block;margin-top:7px;">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</span>
  </div>
  <script>
    // Shopee Vibe + ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏î‡∏¥‡∏°
    const GOOGLE_SHEET_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxvkT44c1V26IyzQW_4FhR4iQ0gmrNvdhF5TnneqNZ-21JXFczyZBo-8EFzhA69WshT/exec';
    const products = [
      { id: 'B01', text: 'B01 - ‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≤‡∏ß‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á' },
      { id: 'B02', text: 'B02 - ‡∏ú‡∏¥‡∏ß‡∏™‡∏≠‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á' },
      { id: 'B2.5', text: 'B2.5 - ‡∏ú‡∏¥‡∏ß‡∏™‡∏≠‡∏á‡∏™‡∏µ‡∏Ñ‡∏•‡πâ‡∏≥' },
      { id: 'B03', text: 'B03 - ‡∏ú‡∏¥‡∏ß‡∏Ñ‡∏•‡πâ‡∏≥' }
    ];
    // --- ‡πÄ‡∏â‡∏î‡∏™‡∏µ‡∏´‡∏ô‡πâ‡∏≤ product card (sync ‡∏Å‡∏±‡∏ö modal)
    const optionsContainer = document.getElementById('optionsContainer');
    products.forEach(product => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'option-btn';
      btn.textContent = product.text;
      btn.dataset.value = `${product.text} - 299 ‡∏ö‡∏≤‡∏ó`;
      btn.onclick = () => {
        document.querySelectorAll('#optionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        // sync ‡πÑ‡∏õ modal
        document.querySelectorAll('#modalOptionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        document.querySelector(`#modalOptionsContainer .option-btn[data-value="${btn.dataset.value}"]`).classList.add('selected');
        document.getElementById('productInput').value = btn.dataset.value;
      };
      optionsContainer.appendChild(btn);
    });
    // --- ‡πÄ‡∏â‡∏î‡∏™‡∏µ‡πÉ‡∏ô modal
    const modalOptionsContainer = document.getElementById('modalOptionsContainer');
    products.forEach(product => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'option-btn';
      btn.textContent = product.text;
      btn.dataset.value = `${product.text} - 299 ‡∏ö‡∏≤‡∏ó`;
      btn.onclick = () => {
        document.querySelectorAll('#modalOptionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        // sync ‡πÑ‡∏õ product
        document.querySelectorAll('#optionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        document.querySelector(`#optionsContainer .option-btn[data-value="${btn.dataset.value}"]`).classList.add('selected');
        document.getElementById('productInput').value = btn.dataset.value;
      };
      modalOptionsContainer.appendChild(btn);
    });
    // Modal control
    const buyNowModal = document.getElementById('buyNowModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const buyNowBtn = document.getElementById('buyNowBtn');
    const buyNowBtn2 = document.getElementById('buyNowBtn2');
    function openModal() { buyNowModal.style.display = 'flex'; }
    function closeModal() { buyNowModal.style.display = 'none'; }
    buyNowBtn.addEventListener('click', openModal);
    buyNowBtn2.addEventListener('click', openModal);
    closeModalBtn.addEventListener('click', closeModal);
    buyNowModal.addEventListener('click', (event) => {
      if (event.target === buyNowModal) { closeModal(); }
    });

    // ===== Facebook Pixel Event Functions =====
    function fbPurchaseEvent(orderValue = 299) {
      if (typeof fbq !== "undefined") {
        fbq('track', 'Purchase', {
          value: orderValue,
          currency: 'THB'
        });
      }
    }
    function fbAddLineEvent() {
      if (typeof fbq !== "undefined") {
        fbq('trackCustom', 'AddLine');
      }
    }
    // Add event to all .line-btn
    document.querySelectorAll('.line-btn').forEach(function(el) {
      el.addEventListener('click', fbAddLineEvent);
    });
    // ===== End Facebook Pixel Event Functions =====

    // ‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
    function sendOrderToSheet(event) {
      event.preventDefault();
      const orderForm = document.getElementById('orderForm');
      const submitButton = document.getElementById('submitBtn');
      const originalButtonText = submitButton.textContent;
      if (!document.getElementById('productInput').value) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏î‡∏™‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞!');
        return;
      }
      submitButton.disabled = true;
      submitButton.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
      const formData = new FormData(orderForm);
      // Make sure phone is sent as string with leading zero
      const phoneField = orderForm.querySelector('#phone');
      if (phoneField && phoneField.value && !phoneField.value.startsWith("'")) {
        formData.set('phone', "'" + phoneField.value);
      }
      formData.set("order_id", 'ORD-' + Date.now());
      fetch(GOOGLE_SHEET_WEB_APP_URL, {
        method: "POST", body: formData
      })
      .then(response => response.json())
      .then(data => {
        submitButton.disabled = false;
        submitButton.textContent = originalButtonText;
        if (data.result === 'success') {
          closeModal();
          orderForm.reset();
          document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
          document.getElementById('productInput').value = '';
          // Popup success
          const successPopup = document.getElementById('successPopup');
          successPopup.style.display = 'block';
          setTimeout(() => { successPopup.style.display = 'none'; }, 2400);

          // === Facebook Pixel: Purchase Event ===
          fbPurchaseEvent(299);

        } else {
          alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (data.message || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'));
        }
      })
      .catch(err => {
        submitButton.disabled = false;
        submitButton.textContent = originalButtonText;
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: " + err.message);
        console.error("Fetch Error:", err);
      });
    }
  </script>
</body>
</html>
